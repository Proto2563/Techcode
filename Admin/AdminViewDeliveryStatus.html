<!DOCTYPE html>
<html>
<head>
  <title>Your Donations</title>
</head>
<body>

<h2>Donations Delivery Status</h2>
<table border="1" id="donationTable">
  <thead>
    <tr>
      <th>Item ID</th>
      <th>Donor ID</th>
      <th>Item Name</th>
      <th>Category</th>
      <th>Drop Location</th>
      <th>Image</th>
      <th>Delivered by Donor</th>
      <th>DelCode</th>
      <th>Delivered to NGO</th>
      <th>Ngo Delivery Code</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  window.onload = function () {
    const urlParams = new URLSearchParams(window.location.search);
    const AID = urlParams.get('AID');

    if (!AID) {
      alert("Admin ID missing");
      return;
    }

    fetch(`http://localhost:3000/AdminViewDeliveryStatus`)
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          const tbody = document.querySelector("#donationTable tbody"); //Finds tbody part of table where results will be inserted
//console.log("Data from backend:", data.donations);
          data.donations.forEach(item => {
            //console.log(item);  // ADD THIS TOO
            const row = document.createElement("tr");

            row.innerHTML = `
              <td>${item.IID}</td>
              <td>${item.DID}</td>
              <td>${item.IName}</td>
              <td>${item.ICategory}</td>
              <td>${item.IDropLoc}</td>
              <td><img src="../Photo/${item.IPhoto}" width="100"/></td>
              <td>${item.DelStatus}</td>
              <td>${item.DelStatus === "Not Delivered" ? item.DelCode : ""}</td>
              <td>${item.NgoDelStatus}</td>
              <td>${item.NgoDelCode}</td>
            `;
            //<img src="../Photo/${item.IPhoto}" width="100"/>

            tbody.appendChild(row); //Adds row to end of tbody
          });
        } else {
          alert("Failed to fetch donations");
        }
      })

      .catch(err => {
        console.error("Fetch error:", err);
      });
  };
</script>

</body>
</html>

